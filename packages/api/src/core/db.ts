[
  {
    "file": "/packages/api/src/core/db.ts",
    "content": "/*\n * Arquivo: /packages/api/src/core/db.ts\n * O Quê (Lógica): Abstrair a criação dos clientes de DB (Drizzle) e Auth (Supabase).\n * DIP (2.9) / Pilar 24: Este arquivo é a \"fábrica\" que lê Env Vars genéricas\n * e instancia clientes específicos.\n */\n\nimport { drizzle, type PostgresJsDatabase } from 'drizzle-orm/postgres-js'; // \nimport postgres from 'postgres'; // \nimport { createClient, type SupabaseClient } from '@supabase/supabase-js'; // \nimport type { Bindings } from '../types';\n\n// O schema virá do Módulo 2 (PLANO_DE_FEATURE_MOD2)\n// Assumindo que o módulo 2 (db-schema) está disponível no monorepo\n// como '@salonflow/db-schema'\nimport * as schema from '@salonflow/db-schema';\n\n/**\n * Cria e retorna um cliente Drizzle conectado ao banco de dados.\n * Utiliza a URL genérica do banco de dados das bindings.\n */\nexport function createDbClient(\n  env: Bindings\n): PostgresJsDatabase<typeof schema> { \n  const queryClient = postgres(env.DATABASE_URL); // \n  return drizzle(queryClient, { schema }); // \n}\n\n/**\n * Cria e retorna um cliente de autenticação (Supabase).\n * Utiliza a URL e a Chave genéricas do provedor de auth das bindings.\n */\nexport function createAuthClient(env: Bindings): SupabaseClient {\n  return createClient(env.AUTH_PROVIDER_URL, env.AUTH_PROVIDER_KEY); // \n}\n"
  }
]